source $HOME/.bash_profile
okta-aws default sts get-caller-identity
aws s3 cp /data/nifi/aws/bootstrap.sh s3://vsat-lmtd/bootstrap.sh
aws s3 cp /data/nifi/aws/myzep.py s3://vsat-lmtd/myzep.py
aws s3 cp /data/nifi/aws/bootstrap_exp.sh s3://vsat-lmtd/bootstrap_exp.sh
aws emr create-cluster --applications Name=Hadoop Name=Hive Name=Spark Name=Livy Name=Zeppelin --ec2-attributes '{"KeyName":"vsat","InstanceProfile":"EMR_EC2_DefaultRole","SubnetId":"subnet-00f15deb2d1bc77ab","EmrManagedSlaveSecurityGroup":"sg-0786c4f2eacf49462","EmrManagedMasterSecurityGroup":"sg-0b6b7fa369978c5a4"}' --release-label emr-5.23.0 --log-uri 's3n://jupstats/logs/' --instance-groups '[{"InstanceCount":1,"BidPrice":"OnDemandPrice","EbsConfiguration":{"EbsBlockDeviceConfigs":[{"VolumeSpecification":{"SizeInGB":32,"VolumeType":"gp2"},"VolumesPerInstance":1}]},"InstanceGroupType":"MASTER","InstanceType":"c5d.18xlarge","Name":"Master - 1"}]' --configurations '[{"Classification":"spark-defaults","Properties":{"spark.driver.memory":"7424M","spark.jars.packages":"org.apache.spark:spark-avro_2.11:2.4.0,julioasotodv:spark-tree-plotting:0.2,databricks:spark-deep-learning:1.5.0-spark2.4-s_2.11","spark.sql.execution.arrow.enabled":"true","spark.jars":"/opt/flint.jar"}},{"Classification":"zeppelin-env","Properties":{},"Configurations":[{"Classification":"export","Properties":{"ZEPPELIN_INTERPRETER_OUTPUT_LIMIT":"102400000","ZEPPELIN_SPARK_MAXRESULT":"100000","ZEPPELIN_NOTEBOOK_S3_BUCKET":"vsat-lmtd","ZEPPELIN_MEM":"-Xmx16g -XX:MaxPermSize=8g","ZEPPELIN_INTP_MEM":"-Xmx8g -XX:MaxPermSize=4g","ZEPPELIN_NOTEBOOK_S3_USER":"echiu","ZEPPELIN_NOTEBOOK_STORAGE":"org.apache.zeppelin.notebook.repo.S3NotebookRepo"}}]},{"Classification":"spark-env","Properties":{},"Configurations":[{"Classification":"export","Properties":{"PYSPARK_PYTHON":"/usr/bin/python3"}}]}]' --auto-scaling-role EMR_AutoScaling_DefaultRole --bootstrap-actions '[{"Path":"s3://vsat-lmtd/bootstrap_exp.sh","Name":"Custom action"}]' --ebs-root-volume-size 10 --service-role EMR_DefaultRole --enable-debugging --name "emr5_23_spot_notf" --scale-down-behavior TERMINATE_AT_TASK_COMPLETION --region us-east-1
~

