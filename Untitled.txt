
def squared(s):
  return s * s
spark.udf.register("squaredWithPython", squared)

from pyspark.sql.types import LongType
def squared_typed(s):
  return s * s
spark.udf.register("squaredWithPython", squared, LongType())

spark.range(1, 20).registerTempTable("test")

%%sql 
select id, squaredWithPython(id) as id_squared from test
